{"ast":null,"code":"var _jsxFileName = \"/Users/appleone/Documents/Distributed_Systems_Project/main/src/Pages/Home.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from \"react\";\nimport Box from \"@mui/material/Box\";\nimport Vote from \"./Vote\";\nimport Admin from \"./Admin\";\nimport ElectionContract from \"../contracts/Election.json\";\nimport getWeb3 from \"../utils/getWeb3\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function Home() {\n  _s();\n  const [role, setRole] = useState(2);\n  const [web3, setWeb3] = useState(null);\n  const [currentAccount, setCurrentAccount] = useState(null);\n  const [contract, setContract] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [electionState, setElectionState] = useState(0);\n  const [winner, setWinner] = useState(null);\n  const loadWeb3 = async () => {\n    try {\n      const web3 = await getWeb3();\n      const accounts = await web3.eth.getAccounts();\n      const networkId = await web3.eth.net.getId();\n      const deployedNetwork = ElectionContract.networks[networkId];\n      const instance = new web3.eth.Contract(ElectionContract.abi, deployedNetwork && deployedNetwork.address);\n      setWeb3(web3);\n      setCurrentAccount(accounts[0]);\n      setContract(instance);\n      console.log(\"init\");\n      setLoading(false);\n    } catch (error) {\n      console.error(\"Error:\", error);\n    }\n  };\n  const getRole = async () => {\n    if (contract) {\n      const user = await contract.methods.getRole(currentAccount).call();\n      setRole(parseInt(user));\n      console.log(\"role:\");\n      setLoading(false);\n    }\n  };\n  const getElectionState = async () => {\n    if (contract) {\n      const state = await contract.methods.electionState().call();\n      setElectionState(parseInt(state));\n      if (parseInt(state) === 2) {\n        getWinner();\n      }\n    }\n  };\n  const getWinner = async () => {\n    if (contract) {\n      const winnerId = await contract.methods.getWinner().call();\n      setWinner(winnerId);\n    }\n  };\n  useEffect(() => {\n    loadWeb3();\n  }, []);\n  useEffect(() => {\n    getRole();\n    getElectionState();\n  }, [contract]);\n  return /*#__PURE__*/_jsxDEV(Box, {\n    sx: {\n      bgcolor: \"background.default\",\n      color: \"text.primary\",\n      height: \"100vh\"\n    },\n    children: loading ? /*#__PURE__*/_jsxDEV(Box, {\n      sx: {\n        display: \"flex\",\n        justifyContent: \"center\",\n        alignItems: \"center\",\n        height: \"80vh\"\n      },\n      children: \"Loading...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(Box, {\n      children: [role === 1 && /*#__PURE__*/_jsxDEV(Admin, {\n        role: role,\n        contract: contract,\n        web3: web3,\n        currentAccount: currentAccount\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 13\n      }, this), role === 2 && /*#__PURE__*/_jsxDEV(Vote, {\n        role: role,\n        contract: contract,\n        web3: web3,\n        currentAccount: currentAccount,\n        electionState: electionState,\n        winner: winner\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 103,\n        columnNumber: 13\n      }, this), role === 3 && /*#__PURE__*/_jsxDEV(Box, {\n        sx: {\n          display: \"flex\",\n          justifyContent: \"center\",\n          alignItems: \"center\",\n          height: \"80vh\"\n        },\n        children: \"Unauthorized User\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 114,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 9\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 73,\n    columnNumber: 5\n  }, this);\n}\n_s(Home, \"YdpStBo3CacPaYY/bMdzbn34+Ds=\");\n_c = Home;\nvar _c;\n$RefreshReg$(_c, \"Home\");","map":{"version":3,"names":["React","useEffect","useState","Box","Vote","Admin","ElectionContract","getWeb3","jsxDEV","_jsxDEV","Home","_s","role","setRole","web3","setWeb3","currentAccount","setCurrentAccount","contract","setContract","loading","setLoading","electionState","setElectionState","winner","setWinner","loadWeb3","accounts","eth","getAccounts","networkId","net","getId","deployedNetwork","networks","instance","Contract","abi","address","console","log","error","getRole","user","methods","call","parseInt","getElectionState","state","getWinner","winnerId","sx","bgcolor","color","height","children","display","justifyContent","alignItems","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["/Users/appleone/Documents/Distributed_Systems_Project/main/src/Pages/Home.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport Box from \"@mui/material/Box\";\nimport Vote from \"./Vote\";\nimport Admin from \"./Admin\";\nimport ElectionContract from \"../contracts/Election.json\";\nimport getWeb3 from \"../utils/getWeb3\";\n\nexport default function Home() {\n  const [role, setRole] = useState(2);\n  const [web3, setWeb3] = useState(null);\n  const [currentAccount, setCurrentAccount] = useState(null);\n  const [contract, setContract] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [electionState, setElectionState] = useState(0);\n  const [winner, setWinner] = useState(null);\n\n  const loadWeb3 = async () => {\n    try {\n      const web3 = await getWeb3();\n      const accounts = await web3.eth.getAccounts();\n      const networkId = await web3.eth.net.getId();\n      const deployedNetwork = ElectionContract.networks[networkId];\n      const instance = new web3.eth.Contract(\n        ElectionContract.abi,\n        deployedNetwork && deployedNetwork.address\n      );\n      setWeb3(web3);\n      setCurrentAccount(accounts[0]);\n      setContract(instance);\n      console.log(\"init\");\n      setLoading(false);\n    } catch (error) {\n      console.error(\"Error:\", error);\n    }\n  };\n\n  const getRole = async () => {\n    if (contract) {\n      const user = await contract.methods.getRole(currentAccount).call();\n      setRole(parseInt(user));\n      console.log(\"role:\");\n      setLoading(false);\n    }\n  };\n\n  const getElectionState = async () => {\n    if (contract) {\n      const state = await contract.methods.electionState().call();\n      setElectionState(parseInt(state));\n      if (parseInt(state) === 2) {\n        getWinner();\n      }\n    }\n  };\n\n  const getWinner = async () => {\n    if (contract) {\n      const winnerId = await contract.methods.getWinner().call();\n      setWinner(winnerId);\n    }\n  };\n\n  useEffect(() => {\n    loadWeb3();\n  }, []);\n\n  useEffect(() => {\n    getRole();\n    getElectionState();\n  }, [contract]);\n\n  return (\n    <Box\n      sx={{\n        bgcolor: \"background.default\",\n        color: \"text.primary\",\n        height: \"100vh\",\n      }}\n    >\n      {loading ? (\n        <Box\n          sx={{\n            display: \"flex\",\n            justifyContent: \"center\",\n            alignItems: \"center\",\n            height: \"80vh\",\n          }}\n        >\n          Loading...\n        </Box>\n      ) : (\n        <Box>\n          {role === 1 && (\n            <Admin\n              role={role}\n              contract={contract}\n              web3={web3}\n              currentAccount={currentAccount}\n            />\n          )}\n\n          {role === 2 && (\n            <Vote\n              role={role}\n              contract={contract}\n              web3={web3}\n              currentAccount={currentAccount}\n              electionState={electionState}\n              winner={winner}\n            />\n          )}\n\n          {role === 3 && (\n            <Box\n              sx={{\n                display: \"flex\",\n                justifyContent: \"center\",\n                alignItems: \"center\",\n                height: \"80vh\",\n              }}\n            >\n              Unauthorized User\n            </Box>\n          )}\n        </Box>\n      )}\n    </Box>\n  );\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}